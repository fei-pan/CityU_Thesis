% !TeX program = xelatex
\documentclass[a4paper,12pt,twoside,times,PageStyleIII,custommargin,custombib]{PhDThesisPSnPDF}

% ******************************************************************************
% ******************************* Class Options ********************************
% ******************************************************************************

% `a4paper' (default): International A4 size paper, default option.
%
% `11pt' or `12pt'(default): Font Size.
%
% `oneside' or `twoside'(default): Printing double side (twoside) or single
% side. Printed copy of thesis should be typed on both sides of the paper.
%
% `print': Use `print' for print version with appropriate margins and page
% layout. Leaving the options field blank will activate Online version.
%
% ************************* Custom Page Margins ********************************
%
% `custommargin`: Use `custommargin' in options to activate custom page margins,
% which can be defined in the preamble.tex. Custom margin will override the pri-
% nt/online margin setup.
%
% Margins at the binding edge should not be less than 40mm and other margins sh-
% ould not be less than 20mm.
%
% *********************** Choosing the Fonts in Class Options ******************
%
% `times' : Times font with math support.
%
% `fourier': Utopia Font with Fourier Math font (Font has to be installed)
%            It's a free font.
%
% `customfont': Use `customfont' option in the document class and load the
% package in the preamble.tex
%
% default or leave empty: `Latin Modern' font will be loaded.
%
% ********************** Choosing the Bibliography style ***********************
%
% `authoryear': For author-year citation eg., Krishna (2013)
%
% `numbered': (Default Option) For numbered and sorted citation e.g., [1,5,2]
%
% `custombib': Define your own bibliography style in the `preamble.tex' file.
%              `\RequirePackage[square, sort, numbers, authoryear]{natbib}'.
%              This can be also used to load biblatex instead of natbib
%              (See Preamble)
%
% **************************** Choosing the Page Style *************************
%
% `default (leave empty)': For Page Numbers in Header (Left Even, Right Odd) and
% Chapter Name in Header (Right Even) and Section Name (Left Odd). Blank Footer.
%
% `PageStyleI': Chapter Name next & Page Number on Even Side (Left Even).
% Section Name & Page Number in Header on Odd Side (Right Odd). Footer is empty.
%
% `PageStyleII': Chapter Name on Even Side (Left Even) in Header. Section Number
% and Section Name in Header on Odd Side (Right Odd). Page numbering in footer.
%
% `PageStyleIII': Chapter Name on Even Side (Center) in Header. Section Number
% and Section Name in Header on Odd Side (Center). Page numbering in footer.

% ******************************************************************************
% ********************************** Preamble **********************************
% ******************************************************************************

% Contains packages and user-defined commands and settings

% ****************************** Custom Margin *********************************

% Add `custommargin' in the document class options to use this section
% Set {innerside margin / outerside margin / topmargin / bottom margin}  and
% other page dimensions
\ifsetCustomMargin
  \RequirePackage[left=37mm,right=30mm,top=35mm,bottom=30mm]{geometry}
  \setFancyHdr % To apply fancy header after geometry package is loaded
\fi

% Add spaces between paragraphs
%\setlength{\parskip}{0.5em}
% Ragged bottom avoids extra whitespace between paragraphs
\raggedbottom
% To remove the excess top spacing for enumeration, list and description
%\usepackage{enumitem}
%\setlist[enumerate,itemize,description]{topsep=0em}

% ******************* Fonts (like different typewriter fonts etc.)*************

% Add `customfont' in the document class option to use this section

\ifsetCustomFont
  % Set your custom font here and use `customfont' in options. Leave empty to
  % load computer modern font (default LaTeX font).
  % \setmainfont{Georgia}
  \setromanfont{Times New Roman}
  \setsansfont{Arial}
  \setmonofont{Courier New}
\fi

% **************************** Custom Packages ********************************
\usepackage{pdfpages}

% ************************* Microtype and SI Units ****************************

\usepackage[super]{nth}
\usepackage{microtype}
\usepackage{siunitx}
    \sisetup{detect-all,math-micro=\text{µ},text-micro=µ,per-mode = symbol,range-phrase = --}

% ************************* Algorithms and Pseudocode *************************

\usepackage{algorithm}\floatstyle{plaintop}
\usepackage{algpseudocode}


% ********************Captions and Hyperreferencing / URL **********************
\usepackage[labelsep=space,tableposition=top,font=small]{caption}

% *************************** Graphics and figures *****************************
% Uncomment the following two lines to force Latex to place the figure.
% Use [H] when including graphics. Note 'H' instead of 'h'
\usepackage{hologo}
\usepackage{float}
\usepackage[framemethod=tikz]{mdframed} % insert text with a framed box

% Subcaption package is also available in the sty folder you can use that by
% uncommenting the following line
% This is for people stuck with older versions of texlive
\usepackage[caption=false]{subfig} % currently provides better vertical spacing than subcaption, dated on 3 February 2021

% ********************************** Tables ************************************
\usepackage{booktabs} % For professional looking tables
\usepackage{multirow}
\usepackage{threeparttable}
\usepackage{multicol}
\usepackage{longtable}
\usepackage{tabularx}
\usepackage{xltabular}
\usepackage{lscape}
\usepackage[twoside]{rotating}

% ************************ Formatting / Footnote *******************************

% Don't break enumeration (etc.) across pages in an ugly manner (default 10000)
\clubpenalty=500
\widowpenalty=500

%\usepackage[perpage]{footmisc} %Range of footnote options


% *************************** Bibliography  and References ********************
\usepackage[capitalise,nameinlink]{cleveref} %Referencing without need to explicitly state fig /table

% Add `custombib' in the document class option to use this section
\ifuseCustomBib
% If you would like to use biblatex for your reference management, as opposed to the default `natbibpackage` pass the option `custombib` in the document class. Comment out the previous line to make sure you don't load the natbib package. Uncomment the following lines and specify the location of references.bib file

\RequirePackage[backend=biber, date=year, style=numeric, citestyle=numeric-comp, sorting=none, natbib=true, backref=true, maxbibnames=99, autolang=hyphen]{biblatex}
\addbibresource{References/CityU.bib} %Location of references.bib only for biblatex, Do not omit the .bib extension from the filename.
\renewcommand*{\mkbibacro}[1]{\MakeUppercase{#1}} % to make DOI uppercase
\fi

% ***************************** Better enumeration ****************************
\usepackage{enumitem}

% ******************************************************************************
% ************************* User Defined Commands ******************************
% ******************************************************************************

% ********************** TOC depth and numbering depth *************************

% \setcounter{secnumdepth}{2}
% \setcounter{tocdepth}{2}

% ******************************* Nomenclature *********************************

\usepackage[intoc]{nomencl}
    \makenomenclature
% To change the name of the Nomenclature section, uncomment the following line
    %\renewcommand{\nomname}{Symbols}

% \usepackage{imakeidx}
%     \makeindex[intoc]

% ********************************* Appendix ***********************************

% The default value of both \appendixtocname and \appendixpagename is `Appendices'. These names can all be changed via:

%\renewcommand{\appendixtocname}{List of appendices}
%\renewcommand{\appendixname}{Appndx}

% ********************************* Layout ***********************************
% \usepackage{layout}
% \makeatletter
% \renewcommand*{\lay@value}[2]{%
% \strip@pt\dimexpr0.351459\dimexpr\csname#2\endcsname\relax\relax mm%
% }
% \makeatother

% ********************************* Lipsum ***********************************
% \usepackage{lipsum}
% \usepackage[math]{blindtext}

% *************************** Graphics and figures *****************************
% Specify one or several paths in which to search for figures.
% Don't miss the last "/".
\graphicspath{{Figures/}{Figures/Chapter1/}{Figures/Chapter2/}{Figures/Chapter3/}{Figures/Chapter4/}{Figures/Chapter5/}{Figures/Chapter6/}}
% \usepackage{pgf,tikz}

% ******************************************************************************
% ************************ Thesis Information & Meta-data **********************
% ******************************************************************************

% Use \texorpdfstring for PDF metadata-friendly title. Usage:
%\texorpdfstring{LaTeX_Version}{PDF Version (non-latex)} eg.,
%\texorpdfstring{$\sigma$}{sigma}

%% The title of the thesis
\title{A Title Sample}
\titlezh{一個標題\\
            示例}
\shorttitle{High-Throughput Microinjection System}

%% The full name of the author
\author{Pan Fei}
\authorzh{潘飛}

%% University
\university{City University of Hong Kong}
\universityzh{香港城市大學}
\universityabbr{CityU}
% Joint PhD Programme
% \partneruniversity{University of Science and Technology of China}

%% Department
\dept{Department of Biomedical Engineering}
\deptzh{生物醫學工程學系}

%% Full title of the Degree
\degreetitle{Doctor of Philosophy} % Master/Doctor of Philosophy as appropriate
\degreetitlezh{哲學博士學位} % 哲學碩士/博士學位 as appropriate
\degreetitleabbr{PhD} % MPhil or PhD as appropriate

%% Submission date
% Default is set as {\monthname[\the\month]\space\the\year}
\degreedate{January 2021}
\degreedatezh{二零二一年一月}

%% Meta information will appear in the PDF meta-information
\subject{Cell Microinjection} \keywords{{Microinjection} {High-throughput}}

% ******************************** Front Matter ********************************
\begin{document}

\frontmatter

\maketitle
\include{Front/dedication}
\include{Front/abstract}
\include{Front/panel}
% \includepdf{Front/panel_sheet.pdf} % the SGS will provide you a new panel sheet
\include{Front/acknowledgement}

% *********************** Adding TOC and List of Figures ***********************

\tableofcontents
\listoffigures
\listoftables
\clearpage
\addcontentsline{toc}{chapter}{List of Algorithms}
\listofalgorithms

\include{Front/nomenclature}
\printnomenclature[3cm]

% ******************************** Main Matter *********************************
\mainmatter
\include{Chapters/chapter1}
\include{Chapters/chapter2}
\include{Chapters/chapter3}
\include{Chapters/chapter6}
\include{Chapters/chapter7}

% ********************************** Back Matter *******************************
% Backmatter should be commented out, if you are using appendices after References
% \backmatter

% ********************************** Bibliography ******************************
\begin{spacing}{0.9}
\printbibliography[heading=bibintoc, title={References}]
\end{spacing}

% \printindex
% ********************************** Appendices ********************************

\begin{appendices} % Using appendices environment for more functionality
\include{Chapters/appendix1}
\include{Chapters/appendix2}
\end{appendices}

\end{document} 